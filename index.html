<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Repaso Oposiciones CARM</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .selector { background: #f5f5f5; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
    .row { display: flex; align-items: center; flex-wrap: wrap; margin: 10px 0; }
    .row h2, .row label { margin-right: 10px; white-space: nowrap; }
    .slider-container { position: relative; width: 300px; }
    /* Dos rangos sobrepuestos */
    .slider-container input[type=range] {
      position: absolute;
      left: 0;
      width: 100%;
      pointer-events: none; /* para permitir interacción con ambos */
      -webkit-appearance: none;
      background: transparent;
    }
    .slider-container input[type=range].min,
    .slider-container input[type=range].max {
      pointer-events: all;
    }
    input[type=range]::-webkit-slider-thumb { pointer-events: all; }
    button, select, input { padding: 8px; font-size: 14px; }
  </style>
</head>
<body>
  <h1>Tests Agrupación Profesional de Servicios CARM</h1>
  <p style="text-align: center;">Preguntas sacadas del <a href="https://efiap.carm.es/web/pagina?IDCONTENIDO=58945&IDTIPO=100&RASTRO=c$m2813,51996"><em>Temario oficial de la EFIAP</em></a></p>
  <div class="selector">
    <div class="row">
      <h2>Selecciona un tema:</h2>
      <select id="temaSelect">
        <option value="all">Todos los temas</option>
      </select>
      <select id="subtemaSelect">
        <option value="all">Tema completo</option>
      </select>
    </div>
    <div class="row">
      <h2>Nº de preguntas:</h2>
      <input type="number" id="numPreguntas" min="5" max="100" value="10" placeholder="Nº de preguntas">
    </div>
    <div class="row">
      <h2>Tasa de aciertos:</h2>
      <span id="minLabel">0%</span>
      <div class="slider-container">
        <input type="range" id="tasaMin" class="min" min="0" max="100" value="0">
        <input type="range" id="tasaMax" class="max" min="0" max="100" value="100">
      </div>
      <span id="maxLabel">100%</span>
    </div>
    <div class="row">
      <label for="antiguo">
        <input type="checkbox" id="antiguo"> Más antiguas primero
      </label>
    </div>
    <div class="row">
      <button id="btnComenzar">Comenzar Test</button>
    </div>
  </div>
  <script>
    const temasYSubtemas = {
      "Constitución": ["Estructura","Título Preliminar","Título I","Título II","Título III","Título IV","Título V","Título VI","Título VII","Título VIII","Título IX","Título X"],
      "Estatuto": ["Organización Institucional","Competencias"],
      "Prevención Riesgos": ["Señalización","EPIs","Primeros Auxilios"]
    };
    function cargarTemas() {
      const temaSelect = document.getElementById('temaSelect');
      Object.keys(temasYSubtemas).forEach(tema => {
        const opt = document.createElement('option'); opt.value = tema; opt.textContent = tema;
        temaSelect.appendChild(opt);
      }); cargarSubtemas();
    }
    function cargarSubtemas() {
      const tema = document.getElementById('temaSelect').value;
      const subSelect = document.getElementById('subtemaSelect');
      subSelect.innerHTML = '<option value="all">Tema completo</option>';
      if(tema!=='all') temasYSubtemas[tema].forEach(sub => {
        const opt = document.createElement('option'); opt.value=sub; opt.textContent=sub;
        subSelect.appendChild(opt);
      });
    }
    document.getElementById('temaSelect').addEventListener('change', cargarSubtemas);

      // Slider dual-thumb
    const minR = document.getElementById('tasaMin');
    const maxR = document.getElementById('tasaMax');
    const minL = document.getElementById('minLabel');
    const maxL = document.getElementById('maxLabel');
    function syncSliders() {
      let minV = parseInt(minR.value);
      let maxV = parseInt(maxR.value);
      if (minV > maxV) { [minV, maxV] = [maxV, minV]; }
      minL.textContent = minV + '%';
      maxL.textContent = maxV + '%';
    }
    minR.addEventListener('input', syncSliders);
    maxR.addEventListener('input', syncSliders);
    syncSliders();

    // Botón Comenzar
    document.getElementById('btnComenzar').addEventListener('click', () => {
      const params = new URLSearchParams({
        tema: document.getElementById('temaSelect').value,
        subtema: document.getElementById('subtemaSelect').value,
        num: document.getElementById('numPreguntas').value,
      tasaMin: minR.value,
        tasaMax: maxR.value,
        antiguo: document.getElementById('antiguo').checked ? '1' : '0'
      });
      window.location.href = `test.html?${params}`;
    });
    cargarTemas();
  </script>
</body>
</html>
